(()=>{"use strict";var e={961:function(e,t,r){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},n.apply(this,arguments)},a=r(83),s=r(209),o=r(664),i=r(101),c=r(788),l={},d={VISA:"visa",MASTERCARD:"mastercard",AMERICAN_EXPRESS:"american-express",DINERS_CLUB:"diners-club",DISCOVER:"discover",JCB:"jcb",UNIONPAY:"unionpay",MAESTRO:"maestro",ELO:"elo",MIR:"mir",HIPER:"hiper",HIPERCARD:"hipercard"},m=[d.VISA,d.MASTERCARD,d.AMERICAN_EXPRESS,d.DINERS_CLUB,d.DISCOVER,d.JCB,d.UNIONPAY,d.MAESTRO,d.ELO,d.MIR,d.HIPER,d.HIPERCARD],p=(0,c.clone)(m);function u(e){return l[e]||a[e]}function g(e,t){void 0===t&&(t=!1);var r=p.indexOf(e);if(!t&&-1===r)throw new Error('"'+e+'" is not a supported card type.');return r}function h(e){var t=[];if(!(0,o.isValidInputType)(e))return t;if(0===e.length)return p.map((function(e){return(0,c.clone)(u(e))}));p.forEach((function(r){var n=u(r);(0,s.addMatchingCardsToResults)(e,n,t)}));var r=(0,i.findBestMatch)(t);return r?[r]:t}h.getTypeInfo=function(e){return(0,c.clone)(u(e))},h.removeCard=function(e){var t=g(e);p.splice(t,1)},h.addCard=function(e){var t=g(e.type,!0);l[e.type]=e,-1===t&&p.push(e.type)},h.updateCard=function(e,t){var r=l[e]||a[e];if(!r)throw new Error('"'.concat(e,"\" is not a recognized type. Use `addCard` instead.'"));if(t.type&&r.type!==t.type)throw new Error("Cannot overwrite type parameter.");var s=(0,c.clone)(r);s=n(n({},s),t),l[s.type]=s},h.changeOrder=function(e,t){var r=g(e);p.splice(r,1),p.splice(t,0,e)},h.resetModifications=function(){p=(0,c.clone)(m),l={}},h.types=d,e.exports=h},209:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addMatchingCardsToResults=void 0;var n=r(788),a=r(256);t.addMatchingCardsToResults=function(e,t,r){var s,o;for(s=0;s<t.patterns.length;s++){var i=t.patterns[s];if((0,a.matches)(e,i)){var c=(0,n.clone)(t);o=Array.isArray(i)?String(i[0]).length:String(i).length,e.length>=o&&(c.matchStrength=o),r.push(c);break}}}},83:e=>{e.exports={visa:{niceType:"Visa",type:"visa",patterns:[4],gaps:[4,8,12],lengths:[16,18,19],code:{name:"CVV",size:3}},mastercard:{niceType:"Mastercard",type:"mastercard",patterns:[[51,55],[2221,2229],[223,229],[23,26],[270,271],2720],gaps:[4,8,12],lengths:[16],code:{name:"CVC",size:3}},"american-express":{niceType:"American Express",type:"american-express",patterns:[34,37],gaps:[4,10],lengths:[15],code:{name:"CID",size:4}},"diners-club":{niceType:"Diners Club",type:"diners-club",patterns:[[300,305],36,38,39],gaps:[4,10],lengths:[14,16,19],code:{name:"CVV",size:3}},discover:{niceType:"Discover",type:"discover",patterns:[6011,[644,649],65],gaps:[4,8,12],lengths:[16,19],code:{name:"CID",size:3}},jcb:{niceType:"JCB",type:"jcb",patterns:[2131,1800,[3528,3589]],gaps:[4,8,12],lengths:[16,17,18,19],code:{name:"CVV",size:3}},unionpay:{niceType:"UnionPay",type:"unionpay",patterns:[620,[62100,62182],[62184,62187],[62185,62197],[62200,62205],[622010,622999],622018,[62207,62209],[623,626],6270,6272,6276,[627700,627779],[627781,627799],[6282,6289],6291,6292,810,[8110,8131],[8132,8151],[8152,8163],[8164,8171]],gaps:[4,8,12],lengths:[14,15,16,17,18,19],code:{name:"CVN",size:3}},maestro:{niceType:"Maestro",type:"maestro",patterns:[493698,[5e5,504174],[504176,506698],[506779,508999],[56,59],63,67,6],gaps:[4,8,12],lengths:[12,13,14,15,16,17,18,19],code:{name:"CVC",size:3}},elo:{niceType:"Elo",type:"elo",patterns:[401178,401179,438935,457631,457632,431274,451416,457393,504175,[506699,506778],[509e3,509999],627780,636297,636368,[650031,650033],[650035,650051],[650405,650439],[650485,650538],[650541,650598],[650700,650718],[650720,650727],[650901,650978],[651652,651679],[655e3,655019],[655021,655058]],gaps:[4,8,12],lengths:[16],code:{name:"CVE",size:3}},mir:{niceType:"Mir",type:"mir",patterns:[[2200,2204]],gaps:[4,8,12],lengths:[16,17,18,19],code:{name:"CVP2",size:3}},hiper:{niceType:"Hiper",type:"hiper",patterns:[637095,63737423,63743358,637568,637599,637609,637612],gaps:[4,8,12],lengths:[16],code:{name:"CVC",size:3}},hipercard:{niceType:"Hipercard",type:"hipercard",patterns:[606282],gaps:[4,8,12],lengths:[16],code:{name:"CVC",size:3}}}},788:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.clone=void 0,t.clone=function(e){return e?JSON.parse(JSON.stringify(e)):null}},101:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.findBestMatch=void 0,t.findBestMatch=function(e){return function(e){var t=e.filter((function(e){return e.matchStrength})).length;return t>0&&t===e.length}(e)?e.reduce((function(e,t){return e?Number(e.matchStrength)<Number(t.matchStrength)?t:e:t})):null}},664:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isValidInputType=void 0,t.isValidInputType=function(e){return"string"==typeof e||e instanceof String}},256:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.matches=void 0,t.matches=function(e,t){return Array.isArray(t)?function(e,t,r){var n=String(t).length,a=e.substr(0,n),s=parseInt(a,10);return t=parseInt(String(t).substr(0,a.length),10),r=parseInt(String(r).substr(0,a.length),10),s>=t&&s<=r}(e,t[0],t[1]):function(e,t){return(t=String(t)).substring(0,e.length)===e.substring(0,t.length)}(e,t)}},20:(e,t,r)=>{var n=r(609),a=Symbol.for("react.element"),s=(Symbol.for("react.fragment"),Object.prototype.hasOwnProperty),o=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,r){var n,c={},l=null,d=null;for(n in void 0!==r&&(l=""+r),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(d=t.ref),t)s.call(t,n)&&!i.hasOwnProperty(n)&&(c[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===c[n]&&(c[n]=t[n]);return{$$typeof:a,type:e,key:l,ref:d,props:c,_owner:o.current}}t.jsx=c,t.jsxs=c},848:(e,t,r)=>{e.exports=r(20)},609:e=>{e.exports=window.React}},t={};function r(n){var a=t[n];if(void 0!==a)return a.exports;var s=t[n]={exports:{}};return e[n].call(s.exports,s,s.exports,r),s.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);const n=window.wp.i18n,a=window.wc.wcBlocksRegistry,s=window.wp.htmlEntities,o=window.wc.wcSettings;var i=r(609),c=r(961),l=r.n(c);const d=window.jQuery;var m=r.n(d),p=r(848);const u=e=>{var t="";const{eventRegistration:r,emitResponse:n,settings:a}=e,{onCheckoutValidationBeforeProcessing:s,onPaymentSetup:o,onCheckoutAfterProcessingWithSuccess:c,onCheckoutAfterProcessingWithError:d}=r,[u,g]=(0,i.useState)(""),[h,y]=(0,i.useState)(""),[_,f]=(0,i.useState)(""),[v,x]=(0,i.useState)(""),[C,S]=(0,i.useState)(!1),[E,w]=(0,i.useState)(""),[j,N]=(0,i.useState)(""),b=(0,i.useRef)(null),M=(0,i.useRef)(null),R=(0,i.useRef)(null),T=(0,i.useRef)(null),O=e=>{let t=e.target.value;if(t=t.replace(/\D/g,""),t.length>16&&(t=t.slice(0,16)),15==t.length||16==t.length){const e=l()(t);if(e.length>0){let t="Unknown";void 0!==e[0].niceType&&(t=e[0].niceType),y(e[0].niceType)}else y("")}0===t.length&&y(""),t=t.replace(/(.{4})/g,"$1 ").trim(),g(t),setTimeout((()=>{b.current.focus()}),0)},I=e=>{x(_);let t=e.target.value,r=!1;"/"==t.substring(t.length-1)&&(r=!0),t=t.replace(/\D/g,""),t=t.substring(0,4),C&&r&&(t=t.slice(0,t.length-1)),t=t.replace(/^0+/,""),""!=t||C||(t="0");let n="",a="",s=!1;for(let e in t)0!=e||["0","1"].includes(t[e])?a=t[e]:(a="0"+t[e],s=!0),1==e&&t[e]>=2&&!s&&(a=2),n.length<4&&(n+=a);let o=n.slice(0,2),i=n.slice(2),c="";o&&(c=o),2==o.length&&(c+=" / "),i.length>0&&(c+=i),f(c),setTimeout((()=>{M.current.focus()}),0)};(0,i.useEffect)((()=>{_.length<v.length?S(!0):S(!1)}),[_,v]);const P=e=>{let t=e.target.value;t=t.replace(/\D/g,""),t=t.substring(0,4),w(t),setTimeout((()=>{R.current.focus()}),0)},k=e=>{let t=e.target.value;N(t),setTimeout((()=>{T.current.focus()}),0)},D=(e="")=>{m()("body").css("overflow","hidden"),e&&m()("#antom-loading-mask").find("p").text(e),m()("#antom-loading-mask").show()};(0,i.useEffect)((()=>{const e=(e,t)=>{const r=document.getElementsByClassName(e);if(r.length>0){const e=r[0];e.textContent=t,e.style.display="block"}else console.warn(`Element with class "${e}" not found.`)};function r(e){const t=document.getElementsByClassName(e);for(let e=0;e<t.length;e++)t[e].style.display="none",t[e].textContent="";0===t.length&&console.warn(`Element with class "${e}" not found.`)}const n=e=>e.replace(/^\s+|\s+$/g,""),o=()=>{var e=new Date,t=e.getFullYear(),r=e.getMonth()+1,n=e.getDate(),a=e.getHours(),s=e.getMinutes(),o=e.getSeconds();return r<10&&(r="0"+r),n<10&&(n="0"+n),a<10&&(a="0"+a),s<10&&(s="0"+s),o<10&&(o="0"+o),t+"-"+r+"-"+n+" "+a+":"+s+":"+o};s((s=>{if((()=>{let e="radio-control-wc-payment-method-options-"+a.payment_method;return m()("#"+e).is(":checked")})()){const s=document.querySelector("input.antom-card-number");let c="";if(s&&(c=s.value),!c)return e("antom-card-number-error",a.card_validate_message.card_empty_error_message),{type:"error",errorMessage:a.card_validate_message.card_empty_error_message};if(!(e=>(e=e.replace(/\D/g,""),/^4[0-9]{12}(?:[0-9]{3})?$/.test(e)||/^5[1-5][0-9]{14}$/.test(e)))(c))return e("antom-card-number-error",a.card_validate_message.card_invalid_error_message),{type:"error",errorMessage:a.card_validate_message.card_invalid_error_message};r("antom-card-number-error");const l=document.querySelector("input.antom-expire-date");let d="";if(l&&(d=l.value),!d)return e("antom-expire-date-error",a.card_validate_message.expiry_empty_error_message),{type:"error",errorMessage:a.card_validate_message.expiry_empty_error_message};if(!(e=>{if(!/^(\d{2}\/\d{2}|\d{2} \/ \d{2})$/.test(e))return!1;const t=e.split("/"),r=parseInt(t[0],10),n=parseInt(t[1],10);return!(n<(new Date).getFullYear()%100||r<1||r>12||new Date(n+2e3,r,0)<new Date)})(d))return e("antom-expire-date-error",a.card_validate_message.expire_invalid_error_message),{type:"error",errorMessage:a.card_validate_message.expire_invalid_error_message};r("antom-expire-date-error");const p=document.querySelector("input.antom-cvc");let u="";if(p&&(u=p.value),!u)return e("antom-cvc-error",a.card_validate_message.cvv_empty_error_message),{type:"error",errorMessage:a.card_validate_message.cvv_empty_error_message};if(!/^\d{3}$/.test(u))return e("antom-cvc-error",a.card_validate_message.cvv_invalid_error_message),{type:"error",errorMessage:a.card_validate_message.cvv_invalid_error_message};r("antom-cvc-error");const g=document.querySelector("input.antom-holder-name");let h="";if(g&&(h=g.value),!h)return e("antom-holder-name-error",a.card_validate_message.holder_name_required),{type:"error",errorMessage:a.card_validate_message.holder_name_required};r("antom-holder-name-error");let y=d.split("/"),_=n(y[0]),f=n(y[1]);const v=(()=>{let e="";for(let t=0;t<31;t++)e+="1234567890"[Math.floor(10*Math.random())];return e=Math.floor(9*Math.random()+1)+e,e})(),x=((e,t,r,n,a="")=>{let s="",o="",i=(a=a.trim()).indexOf(" ");-1!==i?(s=a.substring(0,i),o=a.slice(i).trim()):s=a,a.indexOf()&&(t=t.replace(/\s/g,""));let c={paymentMethodDetail:{paymentMethodDetailType:"card",card:{cardNo:t,expiryMonth:r,expiryYear:n},instUserName:{firstName:s,fullName:a,lastName:o,middleName:""}}};return CryptoJS.AES.encrypt(JSON.stringify(c),e,{mode:CryptoJS.mode.ECB,padding:CryptoJS.pad.Pkcs7}).toString()})(CryptoJS.enc.Utf8.parse(v),c,_,f,h),C=new JSEncrypt,S="-----BEGIN PUBLIC KEY-----\n    "+a.card_public_key.replace(/\s/g,"")+"    -----END PUBLIC KEY-----";C.setPublicKey(S);let E=C.encrypt(v);a.card_token_url;const w={"client-id":a.client_id,"request-time":o(),signature:"algorithm=RSA256, keyVersion=2, signature=testing_signature",encrypt:"algorithm=AES256, keyVersion=0, symmetricKey="+encodeURIComponent(E)};var i=!1;if(D(a.animate_setting.request_to_antom_payments_gateway),m().ajax({type:"POST",url:a.card_token_url,data:x,contentType:"text/plain",headers:w,async:!1,success:function(e){return e&&e.paymentMethodDetail&&e.paymentMethodDetail.card&&e.paymentMethodDetail.card.cardToken?(i=!0,t=e.paymentMethodDetail.card.cardToken,{type:"success"}):{type:"error",errorMessage:a.antom_card_token_fetch_error}},error:function(e,t,r){return{type:"error",errorMessage:a.antom_card_token_fetch_error}}}),!1===i)return{type:"error",errorMessage:a.antom_card_token_fetch_error}}}))}),[n.responseTypes.ERROR,n.responseTypes.SUCCESS,s]),(0,i.useEffect)((()=>{const e=o((()=>t.length?{type:n.responseTypes.SUCCESS,meta:{paymentMethodData:{antom_card_token:t}}}:{type:n.responseTypes.ERROR,message:"There was an error"}));return()=>{e()}}),[o]),(0,i.useEffect)((()=>{const e=c((()=>{D(a.animate_setting.redirect_to_antom_loading_description)}));return()=>{e()}}),[c]),(0,i.useEffect)((()=>{const e=d((()=>{isAntomCardChecked()&&(m()("body").css("overflow","auto"),m()("#antom-loading-mask").hide())}));return()=>{e()}}),[d]);const A=h?a.card_icon_lists[h]:a.card_icon_lists.card,V=a.is_test_mode,B=a.is_logged_in,U=(a.login_warning_message,()=>(0,p.jsxs)("div",{className:"antom-cards",children:[(0,p.jsx)("div",{className:"antom-cards-container",children:(0,p.jsx)("p",{children:"Card Information"})}),(0,p.jsx)("div",{className:"antom-cards-container",children:(0,p.jsxs)("div",{className:"antom-cards-container-item",children:[(0,p.jsxs)("div",{className:"antom-cards-container-item-line",children:[(0,p.jsx)("div",{className:"card-cover",children:A&&(0,p.jsx)("img",{src:A,alt:`${h} icon`})}),(0,p.jsx)("input",{placeholder:"Card number",className:"antom-card-number",value:u,onChange:O,ref:b})]}),(0,p.jsx)("div",{className:"antom-cards-container-item-line antom-cards-container-item-error antom-card-number-error"})]})}),(0,p.jsxs)("div",{className:"antom-cards-container",children:[(0,p.jsxs)("div",{className:"antom-cards-container-item expire-date",children:[(0,p.jsx)("div",{className:"antom-cards-container-item-line",children:(0,p.jsx)("input",{placeholder:"Exipre date",className:"antom-expire-date",value:_,onChange:I,ref:M})}),(0,p.jsx)("div",{className:"antom-cards-container-item-line antom-cards-container-item-error antom-expire-date-error"})]}),(0,p.jsxs)("div",{className:"antom-cards-container-item",children:[(0,p.jsx)("div",{className:"antom-cards-container-item-line",children:(0,p.jsx)("input",{placeholder:"CVC",className:"antom-cvc",value:E,onChange:P,ref:R})}),(0,p.jsx)("div",{className:"antom-cards-container-item-line antom-cards-container-item-error antom-cvc-error"})]})]}),(0,p.jsx)("div",{className:"antom-cards-container",children:(0,p.jsxs)("div",{className:"antom-cards-container-item",children:[(0,p.jsx)("div",{className:"antom-cards-container-item-line",children:(0,p.jsx)("input",{placeholder:"Holder name",className:"antom-holder-name",value:j,onChange:k,ref:T})}),(0,p.jsx)("div",{className:"antom-cards-container-item-line antom-cards-container-item-error antom-holder-name-error"})]})}),V&&(0,p.jsxs)("div",{children:[(0,p.jsx)("p",{className:"antom-test-mode-warning",children:"run in antom test mode"}),(0,p.jsxs)("p",{className:"antom-test-mode-info",children:["you can test with this card number : ",(0,p.jsx)("span",{className:"strong",children:"4054695723100768"})," . expire date with this format : ",(0,p.jsx)("span",{className:"strong",children:" MM / YY"})," , such as ",(0,p.jsx)("span",{className:"strong",children:"02 / 29"}),", CVC with any Three digits, such as ",(0,p.jsx)("span",{className:"strong",children:"123"})]})]})]})),z=e=>{const{login_in_message:t}=e.settings;return(0,p.jsx)("p",{children:t})};return(0,p.jsx)("div",{children:B?(0,p.jsx)(U,{}):(0,p.jsx)(z,{settings:a})})},g=window.wp.blockEditor,h=e=>{const{label:t,onChange:r}=e;return(0,p.jsx)(g.RichText,{tagName:"label",value:t,onChange:r,...(0,g.useBlockProps)()})},y=(0,o.getSetting)("antom_card_data",{}),_=(0,n.__)("V/M Card","antom-payments");let f='<span class="wc-block-components-payment-method-label" style="display:flex;flex-direction:row;align-items:center">';f+=(0,s.decodeEntities)(y.title)||_,Array.isArray(y.icon)&&y.icon.length>0&&(f+='<span class="antom-payment-block-icons antom-payment-icons">',y.icon.forEach((e=>{f+='<img class="antom-payment-icons-item" src="'+e+'"/>'})),f+="</span>"),f+="</span>";const v={name:"antom_card",label:(0,p.jsx)(h,{label:f}),content:(0,p.jsx)(u,{settings:y}),edit:(0,p.jsx)(u,{settings:y}),canMakePayment:()=>!0,ariaLabel:f,paymentMethodId:"antom_card",supports:{features:y.supports}};(0,a.registerPaymentMethod)(v)})();